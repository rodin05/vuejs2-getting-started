<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!--<link rel="stylesheet" href="https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css">-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.15/css/dataTables.bootstrap4.min.css">
    <!--<link rel="stylesheet" href="https://cdn.datatables.net/1.10.15/css/dataTables.bootstrap.min.css">-->
    <!--<link rel="stylesheet" href="https:////cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.6/semantic.min.css">-->
    <!--<link rel="stylesheet" href="https://cdn.datatables.net/1.10.15/css/dataTables.semanticui.min.css">-->
    <style>
        td.highlight {
            font-weight: bold;
            color: blue;
        }
        th { white-space: nowrap; }
    </style>
</head>
<body>
<div style="width: 80%;margin: auto">
    <div id="demo_info"></div>
<table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">
    <thead>
    <tr>
        <th rowspan="2">Name</th>
        <th colspan="2">HR Information</th>
        <th colspan="3">Contact</th>
    </tr>
    <tr>
        <!--<th>Name</th>-->
        <th>Position</th>
        <th class="select-filter">salary</th>
        <th>start_date</th>
        <th>office</th>
        <th>extn</th>
    </tr>
    </thead>
    <tfoot>
    <tr>
        <th colspan="5" style="text-align:right">Total:</th>
        <th></th>
    </tr>
    </tfoot>
</table>
</div>
<!--<script src="https://code.jquery.com/jquery-1.12.4.js"></script>-->
<!--<script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>-->
<!--<script style="https://cdn.datatables.net/1.10.15/js/dataTables.foundation.min.js"></script>-->
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
<!--<script src="https://cdn.datatables.net/1.10.15/js/dataTables.semanticui.min.js"></script>-->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.6/semantic.min.js"></script>-->
<script src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap4.min.js"></script>
<script>
    var eventFired = function ( type ) {
        var n = $('#demo_info')[0];
        n.scrollTop = n.scrollHeight;
    }
        var table =$('#example')
                .on( 'order.dt',  function () { eventFired( 'Order' ); } )
                .on( 'search.dt', function () { eventFired( 'Search' ); } )
                .on( 'page.dt',   function () { eventFired( 'Page' ); } )
                .DataTable({
//            "paging":   false,
//            "ordering": false,
           "info":     false,
     //       "searching": false,
            language: {
                url:'./src/language.json'
            },
            "headerCallback": function( thead, data, start, end, display ) {
                $(thead).find('th').eq(0).html( 'Displaying '+(end-start)+' records' );
            },
            columnDefs: [ {
                "render": function ( data, type, row ) {
                    return data +' ('+ row[3]+')';
                },
                "targets": 0
                }, {
                    targets: [ 1 ],
                    orderData: [ 1, 0 ]
                }, {
                    targets: [ 4 ],
                    orderData: [ 4, 0 ]
                },
            ],
            "order": [[ 4, 'asc' ]],
            "pagingType": "full_numbers",
           // "scrollY":        "50vh",
            "scrollX": true,
             "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
            //"scrollCollapse": true,
            //stateSave: true,
            "columns": [
                { "data": "name" },
                { "data": "hr.position" },
                { "data": "hr.salary" },
                { "data": "hr.start_date" },
                { "data": "contact.0" },
                { "data": "contact.1" },
            ],
            "createdRow": function ( row, data, index ) {
                if ( data.hr.salary.replace(/[\$,]/g, '') * 1 > 150000 ) {
                    $('td', row).eq(2).addClass('highlight');
                }
            },
            "drawCallback": function ( settings ) {
                var api = this.api();
                var rows = api.rows( {page:'current'} ).nodes();
                var last=null;
                api.column(4, {page:'current'} ).data().each( function ( group, i ) {
                    if ( last !== group ) {
                        $(rows).eq( i ).before(
                                '<tr class="group"><td colspan="6">'+group+'</td></tr>'
                        );

                        last = group;
                    }
                } );
            },
            "footerCallback": function ( row, data, start, end, display ) {
                var api = this.api();

                // Remove the formatting to get integer data for summation
                var intVal = function ( i ) {
                    return typeof i === 'string' ?
                    i.replace(/[\$,]/g, '')*1 :
                            typeof i === 'number' ?
                                    i : 0;
                };

                // Total over all pages
                total = api
                        .column( 2 )
                        .data()
                        .reduce( function (a, b) {
                            return intVal(a) + intVal(b);
                        }, 0 );

                // Total over this page
                pageTotal = api
                        .column( 2, { page: 'current'} )
                        .data()
                        .reduce( function (a, b) {
                            return intVal(a) + intVal(b);
                        }, 0 );
                console.log(total,pageTotal)
                // Update footer
                setTimeout(function () {
                    $( api.column( 5 ).footer() ).html(
                            '$'+pageTotal +' ( $'+ total +' total)'
                    );
                },300)

                    },
            "ajax": {
                     url:'./src/datafortable.txt',
                    dataSrc:'result'
            },
            "deferRender": true
        });

        //添加点击事件
        $('#example tbody').on('click', 'tr', function () {
            var data = table.row( this ).data();
           if(data){
               alert( 'You clicked on '+data.name+'\'s row' );
           }
        } );

        // Order by the grouping
        $('#example tbody').on( 'click', 'tr.group', function () {
            var currentOrder = table.order()[0];
            if ( currentOrder[0] === 4 && currentOrder[1] === 'asc' ) {
                table.order( [ 4, 'desc' ] ).draw();
            }
            else {
                table.order( [ 4, 'asc' ] ).draw();
            }
        } );

        //为列加select-filter
        table.columns( '.select-filter' ).every( function () {
            var that = this;

            // Create the select list and search operation
            var select = $('<select />')
                    .appendTo(
                            this.footer()
                    )
                    .on( 'change', function () {
                        that
                                .search( $(this).val() )
                                .draw();
                    } );

            // Get the search data for the first column and add to the select list
            this
                    .cache( 'search' )
                    .sort()
                    .unique()
                    .each( function ( d ) {
                        select.append( $('<option value="'+d+'">'+d+'</option>') );
                    } );
        } );

</script>
</body>
</html>